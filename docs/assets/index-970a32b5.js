(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))g(c);new MutationObserver(c=>{for(const h of c)if(h.type==="childList")for(const w of h.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&g(w)}).observe(document,{childList:!0,subtree:!0});function v(c){const h={};return c.integrity&&(h.integrity=c.integrity),c.referrerPolicy&&(h.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?h.credentials="include":c.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function g(c){if(c.ep)return;c.ep=!0;const h=v(c);fetch(c.href,h)}})();if(!$)var $={map:function(u,a){var v={};return a?u.map(function(g,c){return v.index=c,a.call(v,g)}):u.slice()},naturalOrder:function(u,a){return u<a?-1:u>a?1:0},sum:function(u,a){var v={};return u.reduce(a?function(g,c,h){return v.index=h,g+a.call(v,c)}:function(g,c){return g+c},0)},max:function(u,a){return Math.max.apply(null,a?$.map(u,a):u)}};var N=function(){var u=5,a=8-u,v=1e3;function g(e,t,n){return(e<<2*u)+(t<<u)+n}function c(e){var t=[],n=!1;function d(){t.sort(e),n=!0}return{push:function(r){t.push(r),n=!1},peek:function(r){return n||d(),r===void 0&&(r=t.length-1),t[r]},pop:function(){return n||d(),t.pop()},size:function(){return t.length},map:function(r){return t.map(r)},debug:function(){return n||d(),t}}}function h(e,t,n,d,r,o,f){var l=this;l.r1=e,l.r2=t,l.g1=n,l.g2=d,l.b1=r,l.b2=o,l.histo=f}function w(){this.vboxes=new c(function(e,t){return $.naturalOrder(e.vbox.count()*e.vbox.volume(),t.vbox.count()*t.vbox.volume())})}function y(e,t){if(t.count()){var n=t.r2-t.r1+1,d=t.g2-t.g1+1,r=$.max([n,d,t.b2-t.b1+1]);if(t.count()==1)return[t.copy()];var o,f,l,s,p=0,m=[],b=[];if(r==n)for(o=t.r1;o<=t.r2;o++){for(s=0,f=t.g1;f<=t.g2;f++)for(l=t.b1;l<=t.b2;l++)s+=e[g(o,f,l)]||0;m[o]=p+=s}else if(r==d)for(o=t.g1;o<=t.g2;o++){for(s=0,f=t.r1;f<=t.r2;f++)for(l=t.b1;l<=t.b2;l++)s+=e[g(f,o,l)]||0;m[o]=p+=s}else for(o=t.b1;o<=t.b2;o++){for(s=0,f=t.r1;f<=t.r2;f++)for(l=t.g1;l<=t.g2;l++)s+=e[g(f,l,o)]||0;m[o]=p+=s}return m.forEach(function(x,E){b[E]=p-x}),function(x){var E,M,C,I,L,_=x+"1",O=x+"2",z=0;for(o=t[_];o<=t[O];o++)if(m[o]>p/2){for(C=t.copy(),I=t.copy(),L=(E=o-t[_])<=(M=t[O]-o)?Math.min(t[O]-1,~~(o+M/2)):Math.max(t[_],~~(o-1-E/2));!m[L];)L++;for(z=b[L];!z&&m[L-1];)z=b[--L];return C[O]=L,I[_]=C[O]+1,[C,I]}}(r==n?"r":r==d?"g":"b")}}return h.prototype={volume:function(e){var t=this;return t._volume&&!e||(t._volume=(t.r2-t.r1+1)*(t.g2-t.g1+1)*(t.b2-t.b1+1)),t._volume},count:function(e){var t=this,n=t.histo;if(!t._count_set||e){var d,r,o,f=0;for(d=t.r1;d<=t.r2;d++)for(r=t.g1;r<=t.g2;r++)for(o=t.b1;o<=t.b2;o++)f+=n[g(d,r,o)]||0;t._count=f,t._count_set=!0}return t._count},copy:function(){var e=this;return new h(e.r1,e.r2,e.g1,e.g2,e.b1,e.b2,e.histo)},avg:function(e){var t=this,n=t.histo;if(!t._avg||e){var d,r,o,f,l=0,s=1<<8-u,p=0,m=0,b=0;for(r=t.r1;r<=t.r2;r++)for(o=t.g1;o<=t.g2;o++)for(f=t.b1;f<=t.b2;f++)l+=d=n[g(r,o,f)]||0,p+=d*(r+.5)*s,m+=d*(o+.5)*s,b+=d*(f+.5)*s;t._avg=l?[~~(p/l),~~(m/l),~~(b/l)]:[~~(s*(t.r1+t.r2+1)/2),~~(s*(t.g1+t.g2+1)/2),~~(s*(t.b1+t.b2+1)/2)]}return t._avg},contains:function(e){var t=this,n=e[0]>>a;return gval=e[1]>>a,bval=e[2]>>a,n>=t.r1&&n<=t.r2&&gval>=t.g1&&gval<=t.g2&&bval>=t.b1&&bval<=t.b2}},w.prototype={push:function(e){this.vboxes.push({vbox:e,color:e.avg()})},palette:function(){return this.vboxes.map(function(e){return e.color})},size:function(){return this.vboxes.size()},map:function(e){for(var t=this.vboxes,n=0;n<t.size();n++)if(t.peek(n).vbox.contains(e))return t.peek(n).color;return this.nearest(e)},nearest:function(e){for(var t,n,d,r=this.vboxes,o=0;o<r.size();o++)((n=Math.sqrt(Math.pow(e[0]-r.peek(o).color[0],2)+Math.pow(e[1]-r.peek(o).color[1],2)+Math.pow(e[2]-r.peek(o).color[2],2)))<t||t===void 0)&&(t=n,d=r.peek(o).color);return d},forcebw:function(){var e=this.vboxes;e.sort(function(r,o){return $.naturalOrder($.sum(r.color),$.sum(o.color))});var t=e[0].color;t[0]<5&&t[1]<5&&t[2]<5&&(e[0].color=[0,0,0]);var n=e.length-1,d=e[n].color;d[0]>251&&d[1]>251&&d[2]>251&&(e[n].color=[255,255,255])}},{quantize:function(e,t){if(!e.length||t<2||t>256)return!1;var n=function(s){var p,m=new Array(1<<3*u);return s.forEach(function(b){p=g(b[0]>>a,b[1]>>a,b[2]>>a),m[p]=(m[p]||0)+1}),m}(e);n.forEach(function(){});var d=function(s,p){var m,b,x,E=1e6,M=0,C=1e6,I=0,L=1e6,_=0;return s.forEach(function(O){(m=O[0]>>a)<E?E=m:m>M&&(M=m),(b=O[1]>>a)<C?C=b:b>I&&(I=b),(x=O[2]>>a)<L?L=x:x>_&&(_=x)}),new h(E,M,C,I,L,_,p)}(e,n),r=new c(function(s,p){return $.naturalOrder(s.count(),p.count())});function o(s,p){for(var m,b=s.size(),x=0;x<v;){if(b>=p||x++>v)return;if((m=s.pop()).count()){var E=y(n,m),M=E[0],C=E[1];if(!M)return;s.push(M),C&&(s.push(C),b++)}else s.push(m),x++}}r.push(d),o(r,.75*t);for(var f=new c(function(s,p){return $.naturalOrder(s.count()*s.volume(),p.count()*p.volume())});r.size();)f.push(r.pop());o(f,t);for(var l=new w;f.size();)l.push(f.pop());return l}}}().quantize;const D=function(u){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.width=this.canvas.width=u.naturalWidth,this.height=this.canvas.height=u.naturalHeight,this.context.drawImage(u,0,0,this.width,this.height)};D.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)};var q=function(){};q.prototype.getColor=function(u,a=10){return this.getPalette(u,5,a)[0]},q.prototype.getPalette=function(u,a,v){const g=function(y){let{colorCount:e,quality:t}=y;if(e!==void 0&&Number.isInteger(e)){if(e===1)throw new Error("colorCount should be between 2 and 20. To get one color, call getColor() instead of getPalette()");e=Math.max(e,2),e=Math.min(e,20)}else e=10;return(t===void 0||!Number.isInteger(t)||t<1)&&(t=10),{colorCount:e,quality:t}}({colorCount:a,quality:v}),c=new D(u),h=function(y,e,t){const n=y,d=[];for(let r,o,f,l,s,p=0;p<e;p+=t)r=4*p,o=n[r+0],f=n[r+1],l=n[r+2],s=n[r+3],(s===void 0||s>=125)&&(o>250&&f>250&&l>250||d.push([o,f,l]));return d}(c.getImageData().data,c.width*c.height,g.quality),w=N(h,g.colorCount);return w?w.palette():null},q.prototype.getColorFromUrl=function(u,a,v){const g=document.createElement("img");g.addEventListener("load",()=>{const c=this.getPalette(g,5,v);a(c[0],u)}),g.src=u},q.prototype.getImageData=function(u,a){let v=new XMLHttpRequest;v.open("GET",u,!0),v.responseType="arraybuffer",v.onload=function(){if(this.status==200){let g=new Uint8Array(this.response);i=g.length;let c=new Array(i);for(let y=0;y<g.length;y++)c[y]=String.fromCharCode(g[y]);let h=c.join(""),w=window.btoa(h);a("data:image/png;base64,"+w)}},v.send()},q.prototype.getColorAsync=function(u,a,v){const g=this;this.getImageData(u,function(c){const h=document.createElement("img");h.addEventListener("load",function(){const w=g.getPalette(h,5,v);a(w[0],this)}),h.src=c})};const P=document.querySelector("#app"),A=new q,T=()=>Math.floor(Math.random()*1084+1),k=()=>{P.innerHTML="";const u=new Image;u.crossOrigin="Anonymous",u.src=`https://picsum.photos/id/${T()}/400`,u.classList.add("imagen"),P.append(u),u.addEventListener("error",k),u.addEventListener("load",()=>{const[a,v,g]=A.getColor(u);document.body.style.backgroundColor=`rgb(${a},${v},${g})`;const c=A.getPalette(u),h=document.createElement("div");h.classList.add("box-container"),P.append(h),c.map(w=>{const y=document.createElement("div");y.classList.add("box");const[e,t,n]=w;y.style.backgroundColor=`rgb(${e},${t},${n})`,h.append(y),y.addEventListener("mouseenter",()=>{document.body.style.backgroundColor=`rgb(${e},${t},${n})`}),y.addEventListener("click",()=>{document.body.style.backgroundColor=`rgb(${e},${t},${n})`})})}),u.addEventListener("click",k)};document.addEventListener("DOMContentLoaded",k);
