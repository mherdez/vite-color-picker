(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))g(c);new MutationObserver(c=>{for(const h of c)if(h.type==="childList")for(const y of h.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&g(y)}).observe(document,{childList:!0,subtree:!0});function v(c){const h={};return c.integrity&&(h.integrity=c.integrity),c.referrerPolicy&&(h.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?h.credentials="include":c.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function g(c){if(c.ep)return;c.ep=!0;const h=v(c);fetch(c.href,h)}})();if(!$)var $={map:function(a,n){var v={};return n?a.map(function(g,c){return v.index=c,n.call(v,g)}):a.slice()},naturalOrder:function(a,n){return a<n?-1:a>n?1:0},sum:function(a,n){var v={};return a.reduce(n?function(g,c,h){return v.index=h,g+n.call(v,c)}:function(g,c){return g+c},0)},max:function(a,n){return Math.max.apply(null,n?$.map(a,n):a)}};var N=function(){var a=5,n=8-a,v=1e3;function g(e,t,r){return(e<<2*a)+(t<<a)+r}function c(e){var t=[],r=!1;function s(){t.sort(e),r=!0}return{push:function(u){t.push(u),r=!1},peek:function(u){return r||s(),u===void 0&&(u=t.length-1),t[u]},pop:function(){return r||s(),t.pop()},size:function(){return t.length},map:function(u){return t.map(u)},debug:function(){return r||s(),t}}}function h(e,t,r,s,u,o,d){var f=this;f.r1=e,f.r2=t,f.g1=r,f.g2=s,f.b1=u,f.b2=o,f.histo=d}function y(){this.vboxes=new c(function(e,t){return $.naturalOrder(e.vbox.count()*e.vbox.volume(),t.vbox.count()*t.vbox.volume())})}function x(e,t){if(t.count()){var r=t.r2-t.r1+1,s=t.g2-t.g1+1,u=$.max([r,s,t.b2-t.b1+1]);if(t.count()==1)return[t.copy()];var o,d,f,l,p=0,m=[],b=[];if(u==r)for(o=t.r1;o<=t.r2;o++){for(l=0,d=t.g1;d<=t.g2;d++)for(f=t.b1;f<=t.b2;f++)l+=e[g(o,d,f)]||0;m[o]=p+=l}else if(u==s)for(o=t.g1;o<=t.g2;o++){for(l=0,d=t.r1;d<=t.r2;d++)for(f=t.b1;f<=t.b2;f++)l+=e[g(d,o,f)]||0;m[o]=p+=l}else for(o=t.b1;o<=t.b2;o++){for(l=0,d=t.r1;d<=t.r2;d++)for(f=t.g1;f<=t.g2;f++)l+=e[g(d,f,o)]||0;m[o]=p+=l}return m.forEach(function(w,E){b[E]=p-w}),function(w){var E,M,C,I,L,_=w+"1",O=w+"2",z=0;for(o=t[_];o<=t[O];o++)if(m[o]>p/2){for(C=t.copy(),I=t.copy(),L=(E=o-t[_])<=(M=t[O]-o)?Math.min(t[O]-1,~~(o+M/2)):Math.max(t[_],~~(o-1-E/2));!m[L];)L++;for(z=b[L];!z&&m[L-1];)z=b[--L];return C[O]=L,I[_]=C[O]+1,[C,I]}}(u==r?"r":u==s?"g":"b")}}return h.prototype={volume:function(e){var t=this;return t._volume&&!e||(t._volume=(t.r2-t.r1+1)*(t.g2-t.g1+1)*(t.b2-t.b1+1)),t._volume},count:function(e){var t=this,r=t.histo;if(!t._count_set||e){var s,u,o,d=0;for(s=t.r1;s<=t.r2;s++)for(u=t.g1;u<=t.g2;u++)for(o=t.b1;o<=t.b2;o++)d+=r[g(s,u,o)]||0;t._count=d,t._count_set=!0}return t._count},copy:function(){var e=this;return new h(e.r1,e.r2,e.g1,e.g2,e.b1,e.b2,e.histo)},avg:function(e){var t=this,r=t.histo;if(!t._avg||e){var s,u,o,d,f=0,l=1<<8-a,p=0,m=0,b=0;for(u=t.r1;u<=t.r2;u++)for(o=t.g1;o<=t.g2;o++)for(d=t.b1;d<=t.b2;d++)f+=s=r[g(u,o,d)]||0,p+=s*(u+.5)*l,m+=s*(o+.5)*l,b+=s*(d+.5)*l;t._avg=f?[~~(p/f),~~(m/f),~~(b/f)]:[~~(l*(t.r1+t.r2+1)/2),~~(l*(t.g1+t.g2+1)/2),~~(l*(t.b1+t.b2+1)/2)]}return t._avg},contains:function(e){var t=this,r=e[0]>>n;return gval=e[1]>>n,bval=e[2]>>n,r>=t.r1&&r<=t.r2&&gval>=t.g1&&gval<=t.g2&&bval>=t.b1&&bval<=t.b2}},y.prototype={push:function(e){this.vboxes.push({vbox:e,color:e.avg()})},palette:function(){return this.vboxes.map(function(e){return e.color})},size:function(){return this.vboxes.size()},map:function(e){for(var t=this.vboxes,r=0;r<t.size();r++)if(t.peek(r).vbox.contains(e))return t.peek(r).color;return this.nearest(e)},nearest:function(e){for(var t,r,s,u=this.vboxes,o=0;o<u.size();o++)((r=Math.sqrt(Math.pow(e[0]-u.peek(o).color[0],2)+Math.pow(e[1]-u.peek(o).color[1],2)+Math.pow(e[2]-u.peek(o).color[2],2)))<t||t===void 0)&&(t=r,s=u.peek(o).color);return s},forcebw:function(){var e=this.vboxes;e.sort(function(u,o){return $.naturalOrder($.sum(u.color),$.sum(o.color))});var t=e[0].color;t[0]<5&&t[1]<5&&t[2]<5&&(e[0].color=[0,0,0]);var r=e.length-1,s=e[r].color;s[0]>251&&s[1]>251&&s[2]>251&&(e[r].color=[255,255,255])}},{quantize:function(e,t){if(!e.length||t<2||t>256)return!1;var r=function(l){var p,m=new Array(1<<3*a);return l.forEach(function(b){p=g(b[0]>>n,b[1]>>n,b[2]>>n),m[p]=(m[p]||0)+1}),m}(e);r.forEach(function(){});var s=function(l,p){var m,b,w,E=1e6,M=0,C=1e6,I=0,L=1e6,_=0;return l.forEach(function(O){(m=O[0]>>n)<E?E=m:m>M&&(M=m),(b=O[1]>>n)<C?C=b:b>I&&(I=b),(w=O[2]>>n)<L?L=w:w>_&&(_=w)}),new h(E,M,C,I,L,_,p)}(e,r),u=new c(function(l,p){return $.naturalOrder(l.count(),p.count())});function o(l,p){for(var m,b=l.size(),w=0;w<v;){if(b>=p||w++>v)return;if((m=l.pop()).count()){var E=x(r,m),M=E[0],C=E[1];if(!M)return;l.push(M),C&&(l.push(C),b++)}else l.push(m),w++}}u.push(s),o(u,.75*t);for(var d=new c(function(l,p){return $.naturalOrder(l.count()*l.volume(),p.count()*p.volume())});u.size();)d.push(u.pop());o(d,t);for(var f=new y;d.size();)f.push(d.pop());return f}}}().quantize;const D=function(a){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.width=this.canvas.width=a.naturalWidth,this.height=this.canvas.height=a.naturalHeight,this.context.drawImage(a,0,0,this.width,this.height)};D.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)};var q=function(){};q.prototype.getColor=function(a,n=10){return this.getPalette(a,5,n)[0]},q.prototype.getPalette=function(a,n,v){const g=function(x){let{colorCount:e,quality:t}=x;if(e!==void 0&&Number.isInteger(e)){if(e===1)throw new Error("colorCount should be between 2 and 20. To get one color, call getColor() instead of getPalette()");e=Math.max(e,2),e=Math.min(e,20)}else e=10;return(t===void 0||!Number.isInteger(t)||t<1)&&(t=10),{colorCount:e,quality:t}}({colorCount:n,quality:v}),c=new D(a),h=function(x,e,t){const r=x,s=[];for(let u,o,d,f,l,p=0;p<e;p+=t)u=4*p,o=r[u+0],d=r[u+1],f=r[u+2],l=r[u+3],(l===void 0||l>=125)&&(o>250&&d>250&&f>250||s.push([o,d,f]));return s}(c.getImageData().data,c.width*c.height,g.quality),y=N(h,g.colorCount);return y?y.palette():null},q.prototype.getColorFromUrl=function(a,n,v){const g=document.createElement("img");g.addEventListener("load",()=>{const c=this.getPalette(g,5,v);n(c[0],a)}),g.src=a},q.prototype.getImageData=function(a,n){let v=new XMLHttpRequest;v.open("GET",a,!0),v.responseType="arraybuffer",v.onload=function(){if(this.status==200){let g=new Uint8Array(this.response);i=g.length;let c=new Array(i);for(let x=0;x<g.length;x++)c[x]=String.fromCharCode(g[x]);let h=c.join(""),y=window.btoa(h);n("data:image/png;base64,"+y)}},v.send()},q.prototype.getColorAsync=function(a,n,v){const g=this;this.getImageData(a,function(c){const h=document.createElement("img");h.addEventListener("load",function(){const y=g.getPalette(h,5,v);n(y[0],this)}),h.src=c})};const P=document.querySelector("#app"),A=new q,T=()=>Math.floor(Math.random()*1084+1),k=()=>{P.innerHTML="";const a=document.createElement("div"),n=new Image;n.crossOrigin="Anonymous",n.src=`https://picsum.photos/id/${T()}/400`,n.classList.add("imagen"),a.append(n),P.append(a),n.addEventListener("error",k),n.addEventListener("load",()=>{const[v,g,c]=A.getColor(n);document.body.style.backgroundColor=`rgb(${v},${g},${c})`;const h=A.getPalette(n),y=document.createElement("div");y.classList.add("box-container"),P.append(y),h.map(x=>{const e=document.createElement("div");e.classList.add("box");const[t,r,s]=x;e.style.backgroundColor=`rgb(${t},${r},${s})`,y.append(e),e.addEventListener("mouseenter",()=>{document.body.style.backgroundColor=`rgb(${t},${r},${s})`}),e.addEventListener("click",()=>{document.body.style.backgroundColor=`rgb(${t},${r},${s})`})})}),n.addEventListener("click",k)};document.addEventListener("DOMContentLoaded",k);
